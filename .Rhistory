summarize(count = n()) %>%
mutate(percentage_count = 100*(count/sum(count))) %>%
top_n(percentage_count, n = 10) %>%
ungroup() %>% as.data.frame()
}
result_position_overall = result_position_df %>%
group_by(result_position) %>%
summarize_result_position_df()
ggplot(data= result_position_overall,
aes(x=factor(result_position), y=percentage_count)) +
geom_bar(stat="identity") + ylab("percentage %") + xlab("result position")
result_position_by_date = result_position_df %>%
group_by(date, result_position) %>%
summarize_result_position_df()
ggplot(data= result_position_by_date,
aes(x=factor(result_position), y=percentage_count)) +
geom_bar(stat="identity") + ylab("percentage %") + xlab("result position") +
facet_wrap("date", scales = "free")
events_session_group =
events_log_ts_fixed %>%
mutate(date = as.Date(timestamp)) %>%
group_by(session_id) %>%
arrange(timestamp, desc = F) %>%
summarise(user_group = group[1],
date = as.Date(timestamp[1]),
session_time = max(checkin, na.rm = T),
minimum_n_results = min(n_results, na.rm = T),
num_serp_visits = sum(action == "searchResultPage"),
num_results_clicked = sum(action == "visitPage"),
order_of_events = paste(unique(action), collapse = "-->"),
num_unique_pages_visited = length(unique(page_id))) %>%
mutate(session_time = ifelse(session_time == -Inf, NA, session_time),
minimum_n_results = ifelse(minimum_n_results == Inf, NA, minimum_n_results))
summarize_clickthrough_rate <- function(grouped_df){
grouped_df %>%
summarise(count = n(),
atleast_one_result_clicked = sum(num_results_clicked>0)) %>%
mutate(percentage_clickthrough = 100*(atleast_one_result_clicked/count))
}
clickthrough_rate_overall = events_session_group %>%
group_by(user_group) %>%
summarize_clickthrough_rate()
clickthrough_rate_overall
ggplot(data= clickthrough_rate_overall,
aes(x=factor(user_group), y=percentage_clickthrough)) +
geom_bar(stat="identity") + ylab("percentage %") + xlab("user group")
clickthrough_rate_by_date = events_session_group %>%
group_by(date, user_group) %>%
summarize_clickthrough_rate()
clickthrough_rate_by_date
ggplot(data= clickthrough_rate_overall,
aes(x=factor(user_group), y=percentage_clickthrough)) +
geom_bar(stat="identity") + ylab("percentage %") + xlab("user group") +
facet_wrap("date", scales = "free")
clickthrough_rate_by_date
summarize_clickthrough_rate <- function(grouped_df){
grouped_df %>%
summarise(count = n(),
atleast_one_result_clicked = sum(num_results_clicked>0)) %>%
mutate(percentage_clickthrough = 100*(atleast_one_result_clicked/count)) %>%
ungroup() %>% as.data.frame()
}
clickthrough_rate_overall = events_session_group %>%
group_by(user_group) %>%
summarize_clickthrough_rate()
ggplot(data= clickthrough_rate_overall,
aes(x=factor(user_group), y=percentage_clickthrough)) +
geom_bar(stat="identity") + ylab("percentage %") + xlab("user group")
clickthrough_rate_by_date = events_session_group %>%
group_by(date, user_group) %>%
summarize_clickthrough_rate()
ggplot(data= clickthrough_rate_overall,
aes(x=factor(user_group), y=percentage_clickthrough)) +
geom_bar(stat="identity") + ylab("percentage %") + xlab("user group") +
facet_wrap("date", scales = "free")
ggplot(data= clickthrough_rate_by_date,
aes(x=factor(user_group), y=percentage_clickthrough)) +
geom_bar(stat="identity") + ylab("percentage %") + xlab("user group") +
facet_wrap("date", scales = "free")
# What is our daily overall zero results rate? How does it vary between the groups?
# Create 2 plots, 1 for overall and other faceted by day
summarize_zero_results <- function(grouped_df){
grouped_df %>%
summarise(count = n(),
num_zero_results = sum(minimum_n_results==0, na.rm = T)) %>%
mutate(percentage_zero_results = 100*(num_zero_results/count))
}
zero_results_overall = events_session_group %>%
group_by(user_group) %>%
summarize_zero_results()
zero_results_by_date = events_session_group %>%
group_by(date, user_group) %>%
summarize_zero_results()
zero_results_overall
ggplot(data= zero_results_overall,
aes(x=factor(user_group), y=percentage_zero_results)) +
geom_bar(stat="identity") + ylab("percentage %") + xlab("user group") #+
zero_results_by_date = events_session_group %>%
group_by(date, user_group) %>%
summarize_zero_results()
ggplot(data= zero_results_by_date,
aes(x=factor(user_group), y=percentage_zero_results)) +
geom_bar(stat="identity") + ylab("percentage %") + xlab("user group") +
facet_wrap("date", scales = "free")
correlation_matrix = events_session_group %>%
filter(!is.na(session_time) & !is.na(minimum_n_results)) %>%
# filter(num_serp_visits < 10) %>%
# filter(num_unique_pages_visited < 10) %>%
select(session_time, minimum_n_results, num_serp_visits, num_results_clicked, num_unique_pages_visited) %>%
cor() %>% round(2)
correlation_matrix
correlation_matrix = events_session_group %>%
filter(!is.na(session_time) & !is.na(minimum_n_results)) %>%
# filter(num_serp_visits < 10) %>%
# filter(num_unique_pages_visited < 10) %>%
select(session_time, minimum_n_results, num_serp_visits, num_results_clicked, num_unique_pages_visited) %>%
cor() %>% round(4)
correlation_matrix
melted_correlation_matrix = melt(correlation_matrix)
melted_correlation_matrix
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile()
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() + theme(
axis.title.x = element_blank(),
axis.title.y = element_blank())
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() + theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90))
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() + theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(angle = 45))
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() + theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90))
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() +
geom_tile(color = "white")+
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90))
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90))
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() +
geom_tile(color = "white")+
scale_fill_gradient2(low = "white", high = "black",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90))
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() +
scale_fill_gradient2(low = "white", high = "black",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90))
melted_correlation_matrix
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() +
scale_fill_gradient2(low = "red", high = "green",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90))
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 4) +
scale_fill_gradient2(low = "red", high = "green",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90))
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 3) +
scale_fill_gradient2(low = "red", high = "green",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90))
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 4) +
scale_fill_gradient2(low = "red", high = "green",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90))
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 4) +
scale_fill_gradient2(low = "red", high = "green",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme( axis.title.x = element_blank(), axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90))
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 4) +
scale_fill_gradient2(low = "red", high = "green",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme( axis.title.x = element_blank(), axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90))
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 4) +
scale_fill_gradient2(low = "red", high = "green",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme( axis.title.x = element_blank(), axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90))
ggplot(data= zero_results_overall,
aes(x=factor(user_group), y=percentage_zero_results)) +
geom_bar(stat="identity") + ylab("percentage %") + xlab("user group") #+
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 4) +
scale_fill_gradient2(low = "red", high = "green",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme( axis.title.x = element_blank(), axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90, face = "bold"),
axis.text.y = element_text(face = "bold"))
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 4) +
scale_fill_gradient2(low = "red", high = "green",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme( axis.title.x = element_blank(), axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90, face = "bold", size = 5),
axis.text.y = element_text(face = "bold"))
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 4) +
scale_fill_gradient2(low = "red", high = "green",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme( axis.title.x = element_blank(), axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90, face = "bold", size = 15),
axis.text.y = element_text(face = "bold"))
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 4) +
scale_fill_gradient2(low = "red", high = "green",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme( axis.title.x = element_blank(), axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90, face = "bold", size = 10),
axis.text.y = element_text(face = "bold"))
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 4) +
scale_fill_gradient2(low = "red", high = "green",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme( axis.title.x = element_blank(), axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90, face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10))
ggplot(data= zero_results_by_date,
aes(x=factor(user_group), y=percentage_zero_results)) +
geom_bar(stat="identity") + ylab("percentage %") + xlab("user group") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10)) +
facet_wrap("date", scales = "free")
ggplot(data= zero_results_overall,
aes(x=factor(user_group), y=percentage_zero_results)) +
geom_bar(stat="identity") + ylab("percentage %") + xlab("user group") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10))
ggplot(data= clickthrough_rate_by_date,
aes(x=factor(user_group), y=percentage_clickthrough)) +
geom_bar(stat="identity") + ylab("percentage %") + xlab("user group") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10)) +
facet_wrap("date", scales = "free")
ggplot(data= clickthrough_rate_overall,
aes(x=factor(user_group), y=percentage_clickthrough)) +
geom_bar(stat="identity") + ylab("percentage %") + xlab("user group") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10))
ggplot(data= result_position_by_date,
aes(x=factor(result_position), y=percentage_count)) +
geom_bar(stat="identity") + ylab("percentage %") + xlab("result position") +
facet_wrap("date", scales = "free") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10))
ggplot(data= result_position_overall,
aes(x=factor(result_position), y=percentage_count)) +
geom_bar(stat="identity") + ylab("percentage %") + xlab("result position") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10))
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 4) +
scale_fill_gradient2(low = "red", high = "green",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme( axis.title.x = element_blank(), axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90, face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10))
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 4) +
scale_fill_gradient2(low = "red", high = "green",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme( axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90, face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10))
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 4) +
scale_fill_gradient2(low = "red", high = "green",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme( axis.title.x = element_blank(), axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90, face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10)) +
ggtitle("Correlation Heatmap")
ggplot(data= zero_results_by_date,
aes(x=factor(user_group), y=percentage_zero_results)) +
geom_bar(stat="identity") + ylab("percentage %") + xlab("user group") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10)) +
facet_wrap("date", scales = "free")
ggplot(data= zero_results_by_date,
aes(x=factor(user_group), y=percentage_zero_results)) +
geom_bar(stat="identity") + ylab("percentage zero results") + xlab("user group") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10)) +
facet_wrap("date", scales = "free")
ggplot(data= zero_results_by_date,
aes(x=factor(user_group), y=percentage_zero_results)) +
geom_bar(stat="identity") + ylab("% zero results") + xlab("user group") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10)) +
facet_wrap("date", scales = "free")
ggplot(data= zero_results_by_date,
aes(x=factor(user_group), y=percentage_zero_results)) +
geom_bar(stat="identity") + ylab("zero results %") + xlab("user group") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10)) +
facet_wrap("date", scales = "free")
zero_results_by_date = events_session_group %>%
group_by(date, user_group) %>%
summarize_zero_results()
zero_results_by_date
ggplot(data= result_position_overall,
aes(x=factor(result_position), y=percentage_count)) +
geom_bar(stat="identity") + ylab("percentage %") + xlab("result position") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10))
ggplot(data= result_position_overall,
aes(x=factor(result_position), y=percentage_count)) +
geom_bar(stat="identity") + ylab("Users clicking the result %") + xlab("result position") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10)) +
ggtitle("")
ggplot(data= result_position_overall,
aes(x=factor(result_position), y=percentage_count)) +
geom_bar(stat="identity") + ylab("Users clicking the result %") + xlab("result position") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10)) +
ggtitle("Frequency of Users clicking the result #")
ggplot(data= result_position_overall,
aes(x=factor(result_position), y=percentage_count)) +
geom_bar(stat="identity") + ylab("Users clicking the result %") + xlab("result position") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10)) +
ggtitle("Frequency of Users clicking the result number")
ggplot(data= result_position_by_date,
aes(x=factor(result_position), y=percentage_count)) +
geom_bar(stat="identity") + ylab("Users clicking the result %") + xlab("result position") +
facet_wrap("date", scales = "free") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10)) +
ggtitle("Frequency of Users clicking the result number by date")
events_session_group =
events_log_ts_fixed %>%
mutate(date = as.Date(timestamp)) %>%
group_by(session_id) %>%
arrange(timestamp, desc = F) %>%
summarise(user_group = group[1],
date = as.Date(timestamp[1]),
session_time = max(checkin, na.rm = T),
minimum_n_results = min(n_results, na.rm = T),
num_serp_visits = sum(action == "searchResultPage"),
num_results_clicked = sum(action == "visitPage"),
order_of_events = paste(unique(action), collapse = "-->"),
num_unique_pages_visited = length(unique(page_id))) %>%
mutate(session_time = ifelse(session_time == -Inf, NA, session_time),
minimum_n_results = ifelse(minimum_n_results == Inf, NA, minimum_n_results))
summarize_clickthrough_rate <- function(grouped_df){
grouped_df %>%
summarise(count = n(),
atleast_one_result_clicked = sum(num_results_clicked>0)) %>%
mutate(percentage_clickthrough = 100*(atleast_one_result_clicked/count)) %>%
ungroup() %>% as.data.frame()
}
clickthrough_rate_overall = events_session_group %>%
group_by(user_group) %>%
summarize_clickthrough_rate()
clickthrough_rate_overall
ggplot(data= clickthrough_rate_overall,
aes(x=factor(user_group), y=percentage_clickthrough)) +
geom_bar(stat="identity") + ylab("percentage %") + xlab("user group") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10))
ggplot(data= clickthrough_rate_overall,
aes(x=factor(user_group), y=percentage_clickthrough)) +
geom_bar(stat="identity") + ylab("Clickthrough rate %") + xlab("user group") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10)) +
ggtitle("Clickthrough rate of users by group")
ggplot(data= clickthrough_rate_by_date,
aes(x=factor(user_group), y=percentage_clickthrough)) +
geom_bar(stat="identity") + ylab("Clickthrough rate %") + xlab("user group") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10)) +
facet_wrap("date", scales = "free") +
ggtitle("Clickthrough rate of users by group by date")
events_session_group
# What is our daily overall zero results rate? How does it vary between the groups?
# Create 2 plots, 1 for overall and other faceted by day
summarize_zero_results <- function(grouped_df){
grouped_df %>%
summarise(count = n(),
num_zero_results = sum(minimum_n_results==0, na.rm = T)) %>%
mutate(percentage_zero_results = 100*(num_zero_results/count))
}
zero_results_overall = events_session_group %>%
group_by(user_group) %>%
summarize_zero_results()
ggplot(data= zero_results_overall,
aes(x=factor(user_group), y=percentage_zero_results)) +
geom_bar(stat="identity") + ylab("percentage %") + xlab("user group") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10))
ggplot(data= zero_results_overall,
aes(x=factor(user_group), y=percentage_zero_results)) +
geom_bar(stat="identity") + ylab("zero results %") + xlab("user group") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10))
zero_results_by_date = events_session_group %>%
group_by(date, user_group) %>%
summarize_zero_results()
ggplot(data= zero_results_by_date,
aes(x=factor(user_group), y=percentage_zero_results)) +
geom_bar(stat="identity") + ylab("zero results %") + xlab("user group") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10)) +
facet_wrap("date", scales = "free") +
ggtitle("")
ggplot(data= zero_results_overall,
aes(x=factor(user_group), y=percentage_zero_results)) +
geom_bar(stat="identity") + ylab("zero results %") + xlab("user group") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10)) +
ggtitle("Zero results shown to users by group")
ggplot(data = melted_correlation_matrix, aes(x=Var1, y=Var2, fill=value)) +
geom_tile() +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 4) +
scale_fill_gradient2(low = "red", high = "green",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Correlation") +
theme( axis.title.x = element_blank(), axis.title.y = element_blank(),
axis.text.x = element_text(angle = 90, face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10),
plot.title = element_text(hjust = 0.5)) +
ggtitle("Correlation Heatmap")
ggplot(data= result_position_overall,
aes(x=factor(result_position), y=percentage_count)) +
geom_bar(stat="identity") + ylab("Users clicking the result %") + xlab("result position") +
theme(axis.text.x = element_text(face = "bold", size = 10),
axis.text.y = element_text(face = "bold", size = 10),
plot.title = element_text(hjust = 0.5)) +
ggtitle("Frequency of Users clicking the result number")
install.packages("rmarkdown")
data.frame(a = c(1,2))
data.frame(a = c(1,2)) %>% arrange(a)
data.frame(a = c(1,2)) %>% arrange(a, desc = F)
data.frame(a = c(1,2)) %>% arrange(a, desc = T)
